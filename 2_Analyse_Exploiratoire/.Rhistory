data_Steam = read.csv2(".\\games.csv", encoding = "UTF-8")
data_Steam = read.csv2(".\\games.csv", encoding = "UTF-8")
library(ggplot2)
data_Steam$revenue = as.numeric(data_Steam$revenue)
data_Steam$avgPlaytime = as.numeric(data_Steam$avgPlaytime)
hist(data_Steam$revenue)
data_Steam$revenue = as.numeric(data_Steam$revenue)
data_Steam$avgPlaytime = as.numeric(data_Steam$avgPlaytime)
data_Steam$revenue = as.numeric(data_Steam$revenue)
data_Steam$avgPlaytime = as.numeric(data_Steam$avgPlaytime)
data_Steam$price = as.numeric(data_Steam$price)
hist(data_Steam$price)
data_Steam$revenue = as.numeric(data_Steam$revenue)
data_Steam$avgPlaytime = as.numeric(data_Steam$avgPlaytime)
data_Steam$price = as.numeric(data_Steam$price)
hist(data_Steam$releaseYear)
table(data_Steam$releaseMonth)
barplot(height = table(data_Steam$releaseMonth))
summary(data_Steam)
#summary(subset(data_Steam, subset=data_Steam$copiesSold >= 567 & data_Steam$revenue > 680 & data_Steam$price > 10))
data_test1 <- subset(data_Steam, subset = data_Steam$copiesSold > 567 & data_Steam$revenue > 9816)
summary(data_test1)
data_test2 <- subset(data_test1, subset = data_test1$reviewScore >= 80 & data_test1$price >= 10 & data_test1$releaseYear >= 2023)
summary(data_test2)
#data_test3 <- subset(data_test2, subset = data_test2$revenue >= 18023)
#summary(data_test3)
library(dplyr)
library(ggplot2)
data_link_games_genres = read.csv2("link_games_genres.csv", encoding="UTF-8")
data_link_games_genres = read.csv2("link_games_genres.csv", encoding="UTF-8")
data_genres = read.csv2("genres.csv", encoding = "UTF-8")
data_temp01 = inner_join(data_link_games_genres, data_test1,by="AppID")
data_temp02 = inner_join(data_temp01, data_genres, by="GenresId")
hist(x = data_temp01$releaseYear)
# creation de la colonne year
table(data_temp02$releaseYear)
test_graph01 = ggplot(data = data_temp02, aes(x = data_temp02$releaseYear, y=data_temp02$copiesSold, group = data_temp02$Genres))+
geom_point(aes(color = data_temp02$Genres))
test_graph01
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$Genres == "Action" & data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$avgPlaytime, y=data_test_graph02$recommandations))+
geom_point(aes(color = data_test_graph02$publisherClass))
test_graph02
data_test_graph03 = subset(x = data_temp02, subset=data_temp02$Genres == "Action"& data_temp02$recommandations < max(data_temp02$recommandations))
test_graph03 = ggplot(data_test_graph03, aes(x = data_test_graph03$copiesSold, y=data_test_graph03$recommandations))+
geom_point(aes(color = data_test_graph03$publisherClass))
test_graph03
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$copiesSold, y=data_test_graph02$revenue))+
geom_point(aes(color = data_test_graph02$reviewScore, shape = data_test_graph02$Genres))
test_graph02
data_test_graph02 = data_temp02
test_graph02 = ggplot(data_genres, aes(x = data_genres$numberOfGames, y=data_genres$totalRevenue))+
geom_point(aes(size = data_genres$averagePlayTime))
test_graph02
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$PEGI, y=data_test_graph02$copiesSold, group = data_test_graph02$Genres))+
geom_line(aes(color = data_test_graph02$Genres))
test_graph02
data_test_graph02 = data_temp02
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$PEGI, y=data_test_graph02$revenue))+
geom_point(aes(color = data_test_graph02$Genres))
test_graph02
View(data_Steam)
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$Genres == "Action" & data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$avgPlaytime, y=data_test_graph02$recommandations))+
geom_point(aes(color = data_test_graph02$publisherClass))
test_graph02
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$Genres == "Action" & data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$avgPlaytime, y=data_test_graph02$copiesSold))+
geom_point(aes(color = data_test_graph02$publisherClass))
test_graph02
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$Genres == "Action" & data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$copiesSold, y=data_test_graph02$recommandations))+
geom_point(aes(color = data_test_graph02$publisherClass))
test_graph02
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$Genres == "Action" & data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$revenue, y=data_test_graph02$recommandations))+
geom_point(aes(color = data_test_graph02$publisherClass))
test_graph02
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$Genres == "Action" & data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$price, y=data_test_graph02$recommandations))+
geom_point(aes(color = data_test_graph02$publisherClass))
test_graph02
data_test_graph02 = subset(x = data_temp02, subset=data_temp02$Genres == "Action" & data_temp02$recommandations < max(data_temp02$recommandations))
test_graph02 = ggplot(data_test_graph02, aes(x = data_test_graph02$notes, y=data_test_graph02$recommandations))+
geom_point(aes(color = data_test_graph02$publisherClass))
test_graph02
data_test_graph03 = subset(x = data_temp02, subset=data_temp02$Genres == "Action"& data_temp02$recommandations < max(data_temp02$recommandations))
test_graph03 = ggplot(data_test_graph03, aes(x = data_test_graph03$avgPlaytime, y=data_test_graph03$reviewScore))+
geom_point(aes(color = data_test_graph03$publisherClass))
test_graph03
data_test_graph03 = subset(x = data_temp02, subset=data_temp02$Genres == "Action"& data_temp02$recommandations < max(data_temp02$recommandations))
test_graph03 = ggplot(data_test_graph03, aes(x = data_test_graph03$reviewScore, y=data_test_graph03$recommandations))+
geom_point(aes(color = data_test_graph03$publisherClass))
test_graph03
## Import des packages
library(DBI)
library(ggplot2)
library(cluster)
library(fdm2id)
# Connect to the MySQL database: con
connexion <- DBI::dbConnect(RMySQL::MySQL(),
# A modifier - verifier nom DB.
dbname = "e1735u_Projet_Steam_Doctrine",
host = "devbdd.iutmetz.univ-lorraine.fr",
port = 3306,
user = "e1735u_appli",
password = "32313706")
# # Get table names
tables <- dbListTables(connexion)
# Display structure of tables
str(tables)
# Import the accounts table from mydb
games <- dbReadTable(connexion, "games")
data_games = as.data.frame(games)
data_games.pca = PCA(data_games[,c(15:19,21)])
# enregistrement des graphes de l'ACP :
# - cercles des corr?lations
# - projection sur le premier plan factoriel
# - renvoyer aussi l'inertie totale du premier plan factoriel
graphe_ACP_cercle_cor = plot(data_games.pca, type = "cor")
ggsave("graphe_ACP_cercle_cor.png", plot=graphe_ACP_cercle_cor)
graphe_ACP_projection_points = plot(data_games.pca)
ggsave("graphe_ACP_projection_points.png", plot=graphe_ACP_projection_points)
# inertie
inertie_premier_plan_factoriel = data_games.pca$eig[2,3]
# d?termination du nombre de cluster optimal
nb_cluster_opti = fdm2id::kmeans.getk(data_games.pca$ind$coor)
# application du kmeans
data_games_ACP_kmeans = fdm2id::KMEANS(data_games.pca$ind$coord, k=nb_cluster_opti)
# dÃ©termination du nombre de cluster optimal
nb_cluster_opti = fdm2id::kmeans.getk(data_games.pca$ind$coor)
# application du kmeans
data_games_ACP_kmeans = fdm2id::KMEANS(data_games.pca$ind$coord, k=nb_cluster_opti)
# creation d'un dataframe vide pour accueillir les donn?es de la table games
# avec leur nouvelle var d?signant leur cluster associ?.
data_games_clust = data.frame(Dim1=numeric(), Dim2=numeric(), Dim3=numeric(), Dim4=numeric(), Dim5=numeric(), Dim6=numeric(), cluster=factor())
for (i in 1:nb_cluster_opti) {
# r?cuperation de tous les index de la table de donn?es du premier cluster
index_data_clust = as.vector(which(data_games_ACP_kmeans$cluster == i))
# extraction des donn?es ? partir de l'index et de la table originale.
data_games_clust_temp = as.data.frame(data_games.pca$ind$coord[index_data_clust,])
# ajout de la colonne associ?e au cluster
data_games_clust_temp[, "cluster"] = i
# fusion avec le dataset de resultat.
data_games_clust = rbind(data_games_clust, data_games_clust_temp)
}
data_games.pca$ind$coord=as.matrix(data_games_clust)
data_games_clust =data_games_clust[,c(1,2,7)]
library(plotly)
fig <- plot_ly(data_games_clust, x = ~Dim.1, y = ~Dim.2, color = ~cluster, colors = c('#636EFA','#EF553B'), type = 'scatter', mode = 'markers') %>%
layout(
legend=list(title=list(text='color')),
plot_bgcolor = "#e5ecf6",
xaxis = list(
title = "0"),
yaxis = list(
title = "1"))
for (i in 1:nrow(data_games.pca$var$coord)){
fig <- fig %>%
add_segments(x = 0, xend = 30*data_games.pca$var$coord[i,"Dim.1"], y = 0, yend = 30*data_games.pca$var$coord[i,"Dim.2"], line = list(color = 'black'),inherit = FALSE, showlegend = FALSE) %>%
add_annotations(x=30*data_games.pca$var$coord[i,"Dim.1"], y=30*data_games.pca$var$coord[i,"Dim.2"], ax = 0, ay = 0,text = rownames(data_games.pca$var$coord)[i], xanchor = 'center', yanchor= 'bottom')
}
fig
# Sauvegarde du plot
plotly_IMAGE(fig, format = "png", out_file = "graphe_cluster_projection_acp.png")
ggsave("graphe_cluster_projection_acp_bis.png", plot=fig)
# Sauvegarde du plot
plotly_IMAGE(fig, format = "png", out_file = "graphe_cluster_projection_acp.png")
orca(fig, "graphe_cluster_projection_acp.png")
kaleido(fig, "graphe_cluster_projection_acp.png")
install.packages("htmlwidgets")
library(htmlwidgets)
htmlwidgets::saveWidget(as_widget(fig), "graphe_cluster_projection_acp.png.html")
