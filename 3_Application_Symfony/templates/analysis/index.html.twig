{% extends 'base.html.twig' %}

{% block title %}Hello AnalysisController!{% endblock %}

{% block body %}
<div "main-container-analysis-page">
    <h1>Analysis</h1>
    {% for viewLine in viewGraphFiveDim %}
                <div>
                    <div>
                        <h3>Nom du genre : {{viewLine.label}}</h3>
                        <p>Nombre de jeux : {{viewLine.nbGames}}</p>
                        <p>Note moyenne : {{viewLine.avgReviewScore}}</p>
                    </div>
                </div>
    {% endfor %} 
    <div class="graphFiveDim-container">
        <canva>{{render_chart(chartFiveDim)}}</canva>
    </div>    


    <script>
        function afficherGraphPeriodGenre(testForm) {
            const containerRadioButton = document.querySelector('input[type="radio"][name="form[testForm]"]:checked');
            console.log(containerRadioButton.value);
			$(document).ready(function() {
				$.ajax({
					url: "{{ path('app_analysis_ajax_graph_period') }}",
					type: "POST",
					dataType: "json",
					data: {
						form : testForm
					},
					success: function (response) {
						console.log(response);
					},
                    error: function(jqXHR){         // Fonction à appeler si la requête échoue
						console.log("erreur");
					}
				})
			});
		}
    </script>


    <section class="graphPeriodGenre-container">
        <canva id="graphPeriodGenre">{{render_chart(chartYearGenres)}}</canva>
        <div id="radio-button-period-container">
        {{form_start(form)}}            
        {{ form_widget(form.testForm, {'attr': {'class': 'radio-btn-period-container', 'onclick' : "afficherGraphPeriodGenre('"~ form.testForm.vars.value ~ "')"}}) }}
        {# {{ form_rest(form) }}
        <button type="submit">Enregistrer</button> #}
        {{form_end(form)}} 
        </div>
    </section>  

    

    <a type="button" onclick="afficherGraphPeriodGenre('{{form.testForm.vars.value}}')">test</a> 
    <p>{{form.testForm.vars.value}}</p>
    
    
</div>
{% endblock %}
